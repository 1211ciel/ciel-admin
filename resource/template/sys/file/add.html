<!--
=================================================================================
 This is auto-generated by FreeKey Admin at 2022-06-27 20:13:23. For more information see https://github.com/1211ciel/ciel-admin
=================================================================================
-->
<!DOCTYPE html>
<html lang="zh">
<head>
    {{include "/part/meta.html" .}}
    <title>添加file - {{.Config.server.name}}</title>
</head>
<body>
{{include "/part/top.html" .}}
<div id="wrapper">
    <div class="w">
        <div id="wrapper-left">
            <div class="box no-bottom-border">
                <div class="cell flex-center">
                    <img src="/resource/image/settings.png" alt="Settings" width="62" height="62">
                    <a class="ml-12" href="/file/path?{{toUrlParams .Query}}"> <i class="fa fa-hand-o-left" aria-hidden="true"> 返回</i> </a>
                </div>
                {{.msg}}
                <div class="cell">
                    <a class="link-2-active link-2 " href="#">添加</a>
                </div>
                <div class="flex-center">
                    <form class="cell no-bottom-border" method="post" action="/file/post?{{toUrlParams .Query}}">
                        <table class="table-add" cellspacing="5" cellpadding="0" border="0">
                            <tr>
                                <td></td>
                                <td><span class="tag-info">添加文件</span></td>
                            </tr>
                            <tr>
                                <td width='160' align='right'>url</td>
                                <td width='auto' align='left'><input name='url' required></td>
                            </tr>
                            <tr>
                                <td align='right'>分组</td>
                                <td><select name='group'>
                                    {{option .Config.options.fileGroup ""}}
                                </select>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <button class="btn-info" type="submit">提交</button>
                                </td>
                            </tr>
                        </table>
                    </form>
                    <form class="cell no-bottom-border" action="/file/upload" enctype="multipart/form-data" method="post">
                        <table class="table-add" cellspacing="5" cellpadding="0" border="0">
                            <tr>
                                <td></td>
                                <td><span class="tag-warning">上传文件</span></td>
                            </tr>
                            <tr>
                                <td width='160' align='right'>文件</td>
                                <td width='auto' align='left'><input id="file" name='file' type="file" multiple></td>
                            </tr>
                            <tr>
                                <td align='right'>分组</td>
                                <td><select name='group' id="multiple-group">
                                    {{option .Config.options.fileGroup 5}}
                                </select>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <button class="btn-info" type="submit">提交</button>
                                </td>
                            </tr>
                        </table>
                    </form>
                </div>

            </div>
        </div>
    </div>
</div>
{{include "/part/footer.html" .}}
{{include "/part/endJs.html" .}}
</body>
<script>
    function getFiles() {
        let data = new FormData()
        let files = $('#file')[0].files
        for (let i = 0; i, files.length; i++) {
            let item = files[i]
            if (!item) {
                return data
            }
            data.append('file', item)
        }
        return data
    }

    async function uploadFile() {
        let data = getFiles();
        let g = $('#multiple-group').val()
        if (g == null) {
            alert('请选择分组')
            return
        }
        data.append("group", g)
        const res = await $.ajax({
            url: '/file/upload',
            type: 'post',
            cache: false,
            data: data,
            processData: false,
            contentType: false,
        })
        if (res.code === 0) {
            alert('ok')
        } else {
            alert(res.msg)
        }
    }
</script>
</html>